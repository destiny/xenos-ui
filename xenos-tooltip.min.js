(()=>{const t={useNative:!0,styleId:"xenos-tooltip-style",tooltipId:"xenos-tooltip",contentClass:"xenos-content",arrowClass:"xenos-arrow",gap:8,viewportPad:4,minArrowPad:12,arrowSize:8,debug:!1};class o{constructor(o={}){this.options={...t,...this.readFromCSS(),...o};const e="popover"in HTMLElement.prototype,i="undefined"!=typeof CSS&&"function"==typeof CSS.supports&&(CSS.supports("anchor-name: --a")||CSS.supports("position-anchor: --a")||CSS.supports("position-area: top")||CSS.supports("inset-area: top"));this.useNative=e&&i&&this.options.useNative,this.init()}init(){this.currentTarget=null,this.injectStyle(),this.createTooltip(),this.bindEvents()}setDebugMode(t){this.options.debug=!!t}createTooltip(){if(document.getElementById(this.options.tooltipId))return this.tooltipEl=document.getElementById(this.options.tooltipId),this.contentEl=this.tooltipEl.querySelector(`.${this.options.contentClass}`),void(this.arrowEl=this.tooltipEl.querySelector(`.${this.options.arrowClass}`));this.tooltipEl=document.createElement("div"),this.tooltipEl.id=this.options.tooltipId,this.updateModeClasses(),this.contentEl=document.createElement("div"),this.contentEl.classList.add(this.options.contentClass),this.arrowEl=document.createElement("div"),this.arrowEl.classList.add(this.options.arrowClass),this.tooltipEl.appendChild(this.contentEl),this.tooltipEl.appendChild(this.arrowEl),document.body.appendChild(this.tooltipEl)}updateModeClasses(){this.tooltipEl&&(this.useNative?(this.tooltipEl.setAttribute("popover","manual"),this.tooltipEl.classList.add("xenos-mode-native"),this.tooltipEl.classList.remove("xenos-mode-fallback")):(this.tooltipEl.removeAttribute("popover"),this.tooltipEl.classList.add("xenos-mode-fallback"),this.tooltipEl.classList.remove("xenos-mode-native")))}readFromCSS(){const t=getComputedStyle(document.documentElement),o=parseFloat(t.getPropertyValue("--xenos-tooltip-arrow-size").trim()),e=parseFloat(t.getPropertyValue("--xenos-tooltip-gap").trim()),i=parseFloat(t.getPropertyValue("--xenos-tooltip-min-arrow-pad").trim()),n=parseFloat(t.getPropertyValue("--xenos-tooltip-viewport-pad").trim()),s={};return Number.isNaN(o)||(s.arrowSize=o),Number.isNaN(e)||(s.gap=e),Number.isNaN(i)||(s.minArrowPad=i),Number.isNaN(n)||(s.viewportPad=n),s}injectStyle(){if(document.getElementById(this.options.styleId))return;const t=document.createElement("style");t.id=this.options.styleId,t.textContent=`\n            #${this.options.tooltipId} {\n                z-index: 9999;\n                pointer-events: none;\n                display: block;\n                opacity: 0;\n                visibility: hidden;\n                transition: opacity 0.24s ease;\n                font-size: 12px;\n                overflow: visible;\n            }\n\t\t\t\t\n\t\t\t#${this.options.tooltipId}.visible,\n\t\t\t#${this.options.tooltipId}:popover-open {\n\t\t\t\topacity: 1;\n\t\t\t\tvisibility: visible;\n\t\t\t}\n\t\t\t\n\t\t\t/* --- Fallback Mode Styles --- */\n\t\t\t#${this.options.tooltipId}.xenos-mode-fallback {\n\t\t\t\tposition: fixed;\n\t\t\t\tleft: 0;\n\t\t\t\ttop: 0;\n\t\t\t}\n\t\t\t\n\t\t\t/* --- Native Mode Styles --- */\n\t\t\t#${this.options.tooltipId}.xenos-mode-native {\n\t\t\t\tposition: fixed;\n\t\t\t\tinset: auto;\n\t\t\t\tborder: none;\n\t\t\t\tpadding: 0;\n\t\t\t\tbackground: transparent;\n\t\t\t}\n\t\t\t\n\t\t\t.xenos-content {\n\t\t\t\tbackground: var(--xenos-tooltip-background, #333);\n\t\t\t\tcolor: var(--xenos-tooltip-color, #fff);\n\t\t\t\tpadding: var(--xenos-tooltip-padding, 6px 10px);\n\t\t\t\tborder-radius: var(--xenos-tooltip-border-radius, 4px);\n\t\t\t\tmax-width: var(--xenos-tooltip-max-width, 240px);\n\t\t\t\twidth: max-content;\n\t\t\t\tmin-width: min-content;\n\t\t\t\twhite-space: pre-wrap;\n\t\t\t}\n\t\t\t\n\t\t\t.xenos-arrow {\n\t\t\t    z-index: -1;\n\t\t\t    width: var(--xenos-tooltip-arrow-size, ${this.options.arrowSize}px);\n\t\t\t\theight: var(--xenos-tooltip-arrow-size, ${this.options.arrowSize}px);\n\t\t\t\tposition: absolute;\n\t\t\t\tbackground: var(--xenos-tooltip-background, #333);\n\t\t\t\ttransform: rotate(45deg);\n\t\t\t}\n\t\t\t\n\t\t\t#${this.options.tooltipId}[data-placement="top"] .xenos-arrow {\n\t\t\t\tbottom: ${-this.options.arrowSize/2}px;\n\t\t\t\tleft: var(--arrow-offset, 50%);\n\t\t\t\ttransform: translateX(-50%) rotate(45deg);\n\t\t\t}\n\t\t\t#${this.options.tooltipId}[data-placement="bottom"] .xenos-arrow {\n\t\t\t\ttop: ${-this.options.arrowSize/2}px;\n\t\t\t\tleft: var(--arrow-offset, 50%);\n\t\t\t\ttransform: translateX(-50%) rotate(45deg);\n\t\t\t}\n\t\t\t#${this.options.tooltipId}[data-placement="left"] .xenos-arrow {\n\t\t\t\tright: ${-this.options.arrowSize/2}px;\n\t\t\t\ttop: var(--arrow-offset, 50%);\n\t\t\t\ttransform: translateY(-50%) rotate(45deg);\n\t\t\t}\n\t\t\t#${this.options.tooltipId}[data-placement="right"] .xenos-arrow {\n\t\t\t\tleft: ${-this.options.arrowSize/2}px;\n\t\t\t\ttop: var(--arrow-offset, 50%);\n\t\t\t\ttransform: translateY(-50%) rotate(45deg);\n\t\t\t}\n            `,document.head.appendChild(t)}bindEvents(){this.onEnter=this.onEnter.bind(this),this.onLeave=this.onLeave.bind(this),this.onMove=this.onMove.bind(this),this.onViewportChange=this.onViewportChange.bind(this),document.addEventListener("mouseover",this.onEnter,!0),document.addEventListener("mouseout",this.onLeave,!0),document.addEventListener("mousemove",this.onMove,!0),window.addEventListener("scroll",this.onViewportChange,!0),window.addEventListener("resize",this.onViewportChange)}onEnter(t){const o=t.target?.closest?.("[data-tooltip]");o&&o!==this.currentTarget&&(this.currentTarget=o,this.show(o))}onLeave(t){this.currentTarget&&(t.relatedTarget&&this.currentTarget.contains(t.relatedTarget)||(this.hide(),this.currentTarget=null))}onMove(){this.currentTarget&&!this.useNative&&this.tooltipEl.classList.contains("visible")&&this.showFallback(this.currentTarget)}onViewportChange(){this.currentTarget&&(this.useNative?this.updateArrowPosition(this.tooltipEl.dataset.placement||"top"):this.tooltipEl.classList.contains("visible")&&this.showFallback(this.currentTarget))}show(t){const o=t.dataset.tooltip;if(!o)return;let e=t.dataset.tooltipPlacement;["top","bottom","left","right","top-start","top-end","bottom-start","bottom-end"].includes(e)||(e=void 0),this.contentEl.textContent=o,this.useNative?this.showNative(t,e):this.showFallback(t,e)}hide(){if(this.tooltipEl&&!this.options.debug){if(this.tooltipEl.classList.remove("visible"),this.tooltipEl.style.removeProperty("--arrow-offset"),this.tooltipEl.hidePopover)try{this.tooltipEl.hidePopover()}catch{}this.currentTarget&&this.currentTarget.style.removeProperty("anchor-name")}}showNative(t,o){this.tooltipEl.style.left="",this.tooltipEl.style.top="",this.tooltipEl.style.removeProperty("--arrow-offset"),t.style.setProperty("anchor-name","--xenos-anchor"),this.tooltipEl.style.setProperty("position-anchor","--xenos-anchor"),this.tooltipEl.style.setProperty("position-area","top"),this.tooltipEl.style.setProperty("margin","9999px 0 0 0 "),this.tooltipEl.style.setProperty("visibility","hidden");try{this.tooltipEl.showPopover(),requestAnimationFrame(()=>{if(!this.tooltipEl?.matches(":popover-open"))return;const e=t.getBoundingClientRect(),i=this.tooltipEl.getBoundingClientRect(),n=o||this.chooseBestPlacement(e,{width:i.width,height:i.height});this.applyNativePlacement(n),this.updateArrowPosition(n)})}catch(o){this.showFallback(t)}}applyNativePlacement(t){const o={top:{area:"top span-all",margin:`0 0 ${this.options.gap}px 0`},"top-start":{area:"top left",margin:`${this.options.gap}px`,offset:"50% 0"},"top-end":{area:"top right",margin:`${this.options.gap}px`,offset:"-50% 0"},right:{area:"span-all right",margin:`0 0 0 ${this.options.gap}px`},left:{area:"span-all left",margin:`0 ${this.options.gap}px 0 0`},bottom:{area:"bottom span-all",margin:`${this.options.gap}px 0 0 0`},"bottom-start":{area:"bottom left",margin:`${this.options.gap}px`,offset:"50% 0"},"bottom-end":{area:"bottom right",margin:`${this.options.gap}px`,offset:"-50% 0"}}[t];this.tooltipEl.style.setProperty("position-area",o.area),this.tooltipEl.style.setProperty("margin",o.margin),this.tooltipEl.style.setProperty("translate",o.offset?o.offset:"0"),this.tooltipEl.style.removeProperty("visibility")}showFallback(t,o){this.tooltipEl.classList.add("visible");const e=t.getBoundingClientRect(),i=this.tooltipEl.getBoundingClientRect(),n=o||this.chooseBestPlacement(e,{width:i.width,height:i.height}).split("-")[0],s=this.computePosition(n,e,{width:i.width,height:i.height}),r=this.clampToViewport(s,{width:i.width,height:i.height});this.tooltipEl.style.left=`${r.x}px`,this.tooltipEl.style.top=`${r.y}px`,this.updateArrowPosition(n)}updateArrowPosition(t){const o=t.split("-")[0];this.tooltipEl.dataset.placement=o;const e=this.tooltipEl.getBoundingClientRect(),i=this.currentTarget.getBoundingClientRect(),n="top"===o||"bottom"===o,s=n?i.left+i.width/2:i.top+i.height/2,r=n?e.left:e.top,a=n?e.width:e.height,p=Math.max(this.options.minArrowPad,Math.min(a-this.options.minArrowPad,s-r));this.tooltipEl.style.setProperty("--arrow-offset",`${p}px`)}getTooltipCenter(t,o,e){const i=this.options.gap,n=o.left+o.width/2,s=o.top+o.height/2,r={top:[n,o.top-i-e.height/2],bottom:[n,o.bottom+i+e.height/2],left:[o.left-i-e.width/2,s],right:[o.right+i+e.width/2,s],"top-start":[o.left-i-e.width/2,o.top-i-e.height/2],"top-end":[o.right+i+e.width/2,o.top-i-e.height/2],"bottom-start":[o.left-i-e.width/2,o.bottom+i+e.height/2],"bottom-end":[o.right+i+e.width/2,o.bottom+i+e.height/2]},[a,p]=r[t]||r.top;return{tipCenterX:a,tipCenterY:p}}chooseBestPlacement(t,o){const e=this.options.viewportPad,i=innerWidth,n=innerHeight,s=s=>{const{tipCenterX:r,tipCenterY:a}=this.getTooltipCenter(s,t,o),p=r-o.width/2,l=r+o.width/2,h=a-o.height/2,d=a+o.height/2,c={top:Math.max(0,e-h),bottom:Math.max(0,d-(n-e)),left:Math.max(0,e-p),right:Math.max(0,l-(i-e))};return{total:c.top+c.bottom+c.left+c.right,overflow:c,tipCenterX:r,tipCenterY:a,tipLeft:p,tipTop:h}},r=["top","top-start","top-end","left","right","bottom-start","bottom-end","bottom"].map((t,o)=>({name:t,priority:o,...s(t)})),a=r.find(t=>0===t.total);return a?a.name:(r.sort((t,o)=>t.total!==o.total?t.total-o.total:t.priority-o.priority),r[0].name)}computePosition(t,o,e){const{tipCenterX:i,tipCenterY:n}=this.getTooltipCenter(t,o,e);return{x:i-e.width/2,y:n-e.height/2}}clampToViewport(t,o){const e=this.options.viewportPad;return{x:Math.max(e,Math.min(t.x,innerWidth-o.width-e)),y:Math.max(e,Math.min(t.y,innerHeight-o.height-e))}}}function e(){const t=window.XenosTooltipConfig||{};window.XenosTooltipApi=new o(t)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),window.XenosTooltip=o})();